// ==UserScript==
// @name 全局自定义字体
// @namespace    http://tampermonkey.net/
// @version      0.3
// @description  修改为自定义字体
// @license      MIT
// @author       Lainbo
// @grant        GM_addStyle
// @match        *://*/*
// @run-at       document-start
// @icon         data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAwIDIwMDAiPjxwYXRoIGQ9Ik0xNTAyLjQzIDIwMDBINDk3LjU3QzIyMi43NyAyMDAwIDAgMTc3Ny4yMyAwIDE1MDIuNDNWNDk3LjU3QzAgMjIyLjc3IDIyMi43NyAwIDQ5Ny41NyAwaDEwMDQuODdDMTc3Ny4yMyAwIDIwMDAgMjIyLjc3IDIwMDAgNDk3LjU3djEwMDQuODdjMCAyNzQuNzktMjIyLjc3IDQ5Ny41Ni00OTcuNTcgNDk3LjU2eiIvPjxnIGZpbGw9IiNGRkYiPjxwYXRoIGQ9Ik00MTIgNjYyLjM0YzAtMTU1LjI1IDEyNC4yLTI3OS40NSAyNzkuNDUtMjc5LjQ1aDg0Mi4yMmMzMS4wNSAwIDU0LjM0IDIzLjI5IDU0LjM0IDU0LjM0cy0yMy4yOSA1NC4zNC01NC4zNCA1NC4zNGgtNDI2LjkzbC0zMS4wNSA5Ny4wM2MtMzguODEgMTE2LjQ0LTc3LjYyIDIzNi43NS0xMjAuMzIgMzUzLjE5bC0zNC45MyAxMDguNjdDODgxLjYyIDExNjMuMDEgODQyLjgxIDEyNzkuNDUgODA0IDEzOTJjLTM0LjkzIDEwMC45MS04NS4zOSAxNjMuMDEtMTQzLjYgMTk0LjA2LTU4LjIyIDMxLjA1LTExNi40NCAzMS4wNS0xNTUuMjUgMzEuMDVoLTcuNzZjLTM0LjkzIDAtNjIuMS0yNy4xNy02Mi4xLTYyLjFzMjcuMTctNjIuMSA2Mi4xLTYyLjFjNDIuNjkgMCA3My43NCAwIDEwMC45MS0xNS41MiAyMy4yOS0xMS42NCA1OC4yMi00Mi42OSA4OS4yNy0xMjguMDggMTkuNDEtNTguMjIgNTguMjItMTcwLjc3IDEwNC43OS0yOTguODVsMzQuOTMtMTA4LjY3YzQyLjY5LTEzMS45NiA4OS4yNy0yNjAuMDQgMTMxLjk2LTM5MmwxOS40MS01OC4yMkg2OTEuNDVjLTk3LjAzIDAtMTY2Ljg5IDczLjc0LTE2Ni44OSAxNjYuODkgMCAzNC45My0yNy4xNyA2Mi4xLTU4LjIyIDYyLjFTNDEyIDY5My4zOSA0MTIgNjYyLjM0eiIvPjxwYXRoIGQ9Ik01MDUuMTUgMTY0Mi4xMWgtNy43NmMtNDguODQgMC04Ny4xLTM4LjI2LTg3LjEtODcuMXMzOC4yNi04Ny4xIDg3LjEtODcuMWM0MC40MSAwIDY3LjEgMCA4OC41MS0xMi4yM2wxLjIyLS42NWMxNi4xNC04LjA3IDQ3LjU3LTMzLjYgNzYuODQtMTEzLjk1IDE4LjAxLTU0LjAxIDUyLjE5LTE1My4xNiA5Mi43Ni0yNjUuNjJsNTIuNDItMTU4LjY3YzE5Ljc0LTYwLjQxIDQwLjQzLTEyMC42NyA2MC40OS0xNzkuMTIgMjEuOTEtNjMuODIgNDQuNTYtMTI5LjgxIDY1Ljg0LTE5NS41OGwuMDctLjIxIDguNDQtMjUuMzFINjkxLjQ1Yy04MC44OSAwLTE0MS44OSA2MS0xNDEuODkgMTQxLjg5IDAgMjMuMTYtOC42NyA0NC45OC0yNC40IDYxLjQzLTE1LjYgMTYuMzEtMzcuMDQgMjUuNjctNTguODIgMjUuNjctNDMuNzUgMC03OS4zNC0zNy4zMy03OS4zNC04My4yMiAwLTgxLjc2IDMxLjU1LTE1OC4zNCA4OC44My0yMTUuNjJzMTMzLjg2LTg4LjgzIDIxNS42Mi04OC44M2g4NDIuMjJjMjEuNjkgMCA0MS43NiA4LjExIDU2LjQ5IDIyLjg1IDE0LjczIDE0LjczIDIyLjg1IDM0Ljc5IDIyLjg1IDU2LjQ5cy04LjExIDQxLjc2LTIyLjg1IDU2LjQ5Yy0xNC43MyAxNC43My0zNC43OSAyMi44NS01Ni40OSAyMi44NWgtNDA4LjY4bC0yNS41OCA3OS45NGMtNy43MyAyMy4xOC0xNS42IDQ2Ljk3LTIzLjIyIDY5Ljk4LTI3LjI5IDgyLjQxLTU1LjM5IDE2Ny4yOS04NS4xNiAyNTAuMzFsLTUyLjc1IDE1OC42N2MtMTcuNSA1MC45My0zNS4yIDEwMy4xNC01Mi4zNyAxNTMuOC0xOS4wOSA1Ni4zMi0zOC44MyAxMTQuNTYtNTguMjYgMTcwLjktMzUuMjMgMTAxLjc3LTg3LjUzIDE3MS43My0xNTUuNDcgMjA3Ljk3LTYzLjc1IDMzLjk3LTEyNS45IDMzLjk3LTE2Ny4wMyAzMy45N3ptMTA0Ljk1LTE0Mi42OGMtMzIuNzYgMTguNDgtNjguMDggMTguNDgtMTEyLjcxIDE4LjQ4LTIxLjE1IDAtMzcuMSAxNS45NS0zNy4xIDM3LjEgMCAyMS4xNSAxNS45NSAzNy4xIDM3LjEgMzcuMWg3Ljc2YzM4LjMxIDAgOTAuNzggMCAxNDMuNDgtMjguMTEgNTYuNDYtMzAuMTEgMTAwLjc4LTkwLjczIDEzMS43NC0xODAuMTggMTkuMzgtNTYuMTkgMzkuMDktMTE0LjM2IDU4LjE3LTE3MC42MiAxOS4wOS01Ni4zMiAzOC44My0xMTQuNTYgNTguMjYtMTcwLjlsNS44MS0xNi44NWgxODQuNzJjMTcuMjcgMCAyOS4zNC0xMi4wNiAyOS4zNC0yOS4zNHMtMTIuMDYtMjkuMzQtMjkuMzQtMjkuMzRIOTE5LjU3bDEyLjMyLTMzLjYxYzM0LjA1LTkyLjg2IDY1Ljk2LTE4OS4yMiA5Ni44Mi0yODIuNDIgNy42MS0yMi45OCAxNS40OC00Ni43NSAyMy4yMS02OS45NGwzNi41Ni0xMTQuMjZoNDQ1LjE4YzE3LjI3IDAgMjkuMzQtMTIuMDYgMjkuMzQtMjkuMzRzLTEyLjA2LTI5LjM0LTI5LjM0LTI5LjM0SDY5MS40NUM1NTEuMTQgNDA3Ljg5IDQzNyA1MjIuMDMgNDM3IDY2Mi4zNGMwIDE4LjMyIDEzLjE2IDMzLjIyIDI5LjM0IDMzLjIyIDE4LjAxIDAgMzMuMjItMTYuOTkgMzMuMjItMzcuMSAwLTUyLjA5IDE5LjI2LTEwMC4zNiA1NC4yNC0xMzUuOTEgMzUuNTItMzYuMSA4NC40LTU1Ljk4IDEzNy42NS01NS45OGgzMjEuODlsLTMwLjM0IDkxYy0yMS40MSA2Ni4xNi00NC4xMiAxMzIuMzMtNjYuMDkgMTk2LjMzLTIxLjkxIDYzLjgyLTQ0LjU2IDEyOS44MS02NS44NCAxOTUuNThsLTUuNiAxNy4zSDYzNy4xMWMtMTcuMjcgMC0yOS4zNCAxMi4wNi0yOS4zNCAyOS4zNHMxMi4wNiAyOS4zNCAyOS4zNCAyOS4zNGgxOTAuOTRsLTEyLjIgMzMuNTRjLTQ1Ljc1IDEyNS44Mi04NC45MyAyMzkuMjgtMTA0LjU3IDI5OC4yMWwtLjIyLjY0Yy0yNi43MyA3My41MS02MC43IDEyMS4xNC0xMDAuOTYgMTQxLjU4eiIvPjwvZz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMTMzMSAxMDc1SDYzNWMtNDQuMTggMC04MC0zNS44Mi04MC04MHMzNS44Mi04MCA4MC04MGg2OTZjNDQuMTggMCA4MCAzNS44MiA4MCA4MHMtMzUuODIgODAtODAgODB6Ii8+PC9zdmc+

// ==/UserScript==

;(function () {
  // eslint-disable-next-line prefer-const
  let cssContent = '@font-face{font-family:Cus_Emoji;src:local("Twemoji Mozilla"),local("Segoe UI Emoji"),local("Segoe UI Symbol"),local("Apple Color Emoji"),local("Noto Color Emoji");unicode-range:U+1F000-1F644,U+203C-3299}html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeLegibility}body,html,html:lang(zh) body,html:lang(zh-CN) body,html:lang(zh-SG) body,html:lang(zh-Hans) body,html:lang(cmn) body,html:lang(cmn-Hans) body,html:lang(zh-cmn-Hans) body,html:lang(de) body,html:lang(nl) body,html:lang(en) body,html:lang(nb) body,html:lang(no) body,html:lang(is) body,html:lang(da) body,html:lang(sv) body,html:lang(pt) body,html:lang(es) body,html:lang(fr) body,html:lang(it) body,html:lang(ro) body,html:lang(lv) body,html:lang(lt) body,html:lang(pl) body,html:lang(cs) body,html:lang(sk) body,html:lang(bs) body,html:lang(hr) body,html:lang(sr) body,html:lang(bg) body,html:lang(sl) body,html:lang(ru) body,html:lang(uk) body,html:lang(be) body,html:lang(el) body,html:lang(hu) body,html:lang(et) body,html:lang(fi) body,html:lang(tr) body,html:lang(id) body,html:lang(ms) body{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif}html:lang(ja) body{font-family:"HarmonyOS Sans","Noto Sans JP","HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif}html:lang(ko) body{font-family:"HarmonyOS Sans","Noto Sans KR","HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif}pre,code,kbd,samp{font-family:"JetBrainsMono Nerd Font Mono","Cascadia Mono",Menlo,Monaco,Consolas,"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}button,input,keygen,optgroup,select,textarea{font-family:inherit}@font-face{font-family:"Microsoft YaHei";src:local("HarmonyOS Sans SC"),local("Cus_Emoji"),local("Noto Sans SC"),local("Noto Sans JP"),local("Noto Sans KR"),local("Noto Naskh Arabic"),local("Segoe UI"),local("Roboto"),local("Helvetica"),local("Arial"),local("sans-serif")}@font-face{font-family:"微软雅黑";src:local("HarmonyOS Sans SC"),local("Cus_Emoji"),local("Noto Sans SC"),local("Noto Sans JP"),local("Noto Sans KR"),local("Noto Naskh Arabic"),local("Segoe UI"),local("Roboto"),local("Helvetica"),local("Arial"),local("sans-serif")}@font-face{font-family:"-apple-system";src:local("HarmonyOS Sans SC"),local("Cus_Emoji"),local("Noto Sans SC"),local("Noto Sans JP"),local("Noto Sans KR"),local("Noto Naskh Arabic"),local("Segoe UI"),local("Roboto"),local("Helvetica"),local("Arial"),local("sans-serif")}@font-face{font-family:"TwitterChirp";src:local("HarmonyOS Sans SC"),local("Cus_Emoji"),local("Noto Sans SC"),local("Noto Sans JP"),local("Noto Sans KR"),local("Noto Naskh Arabic"),local("Segoe UI"),local("Roboto"),local("Helvetica"),local("Arial"),local("sans-serif")}@font-face{font-family:"PingFang SC";src:local("HarmonyOS Sans SC"),local("Cus_Emoji"),local("Noto Sans SC"),local("Noto Sans JP"),local("Noto Sans KR"),local("Noto Naskh Arabic"),local("Segoe UI"),local("Roboto"),local("Helvetica"),local("Arial"),local("sans-serif")}@font-face{font-family:"Helvetica";src:local("HarmonyOS Sans SC"),local("Cus_Emoji"),local("Noto Sans SC"),local("Noto Sans JP"),local("Noto Sans KR"),local("Noto Naskh Arabic"),local("Segoe UI"),local("Roboto"),local("Helvetica"),local("Arial"),local("sans-serif")}'
  const fuzzyMatchValueOfMap = (mapMain, key) => {
    const foundEntry = Array.from(mapMain.entries()).find(([k, v]) => key.includes(k))
    return foundEntry ? foundEntry[1] : null
  }
  const domainCssMap = new Map([['baidu.com', '*{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif}'], ['bilibili.com', '.lite-room,.header-channel,.channel-menu-mini,.bb-comment,.list-item .user .text-con,.video-page-card-small .card-box .info .title,.video-info-v1 .video-title,.carousel-tool,.bili-comment.browser-pc *,.bili-dyn-content,.bili-rich-text,.bili-dyn-item,.bili-video-card__info--bottom,.bili-header,.bili-video-card__info--tit,.bili-video-card__info--tit a,.browser-pc *,.video-page-card-small .card-box .info .title,.up-info-v1 .up-info_right .name,.first-line-title,.pl__head,.pl__title{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}'], ['bing.com', 'h1,h2,h3,.b_searchboxForm{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}'], ['feishu.cn', '#zh-CN button,#zh-CN input,#zh-CN select,#zh-CN textarea,.markdown-body{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}.code-block-content,.markdown-body code,.markdown-body pre{font-family:"JetBrainsMono Nerd Font Mono","Cascadia Mono",Menlo,Monaco,Consolas,"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}'], ['github.com', '.react-code-text{font-family:"JetBrainsMono Nerd Font Mono","Cascadia Mono",Menlo,Monaco,Consolas,"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif}#read-only-cursor-text-area,.text-mono{font-family:"JetBrainsMono Nerd Font Mono","Cascadia Mono",Menlo,Monaco,Consolas,"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}'], ['google.com', '*,textarea{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif}h3,textarea{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}'], ['mail.qq.com', 'td,input,button,select,body,.qm_con_body_content,.tcolor,.sub_title{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}'], ['miit.gov.cn', '*{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}'], ['mp.weixin.qq.com', '.wx_wap_page{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}'], ['taobao.com', 'body,button,input,select,textarea{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}'], ['yuque.com', '.doc-title,.ne-engine,.ne-viewer-body,.ne-toc-view,.DocReader-module_title_fXOQi>h1,.catalogTreeItem-module_title_snpKw{font-family:"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}.cm-line,ne-code-content{font-family:"JetBrainsMono Nerd Font Mono","Cascadia Mono",Menlo,Monaco,Consolas,"HarmonyOS Sans SC",Cus_Emoji,"Noto Sans SC","Noto Sans JP","Noto Sans KR","Noto Naskh Arabic","Segoe UI",Roboto,Helvetica,Arial,sans-serif !important}']])
  const domainCss = fuzzyMatchValueOfMap(domainCssMap, window.location.hostname)
  if (domainCss) cssContent += domainCss

  // 通过GM_addStyle添加样式,并且返回是否成功
  function addStyleWithGM (cssText) {
    if (typeof GM_addStyle !== 'undefined') {
      GM_addStyle(cssText)
      return true
    } else {
      return false
    }
  }

  // 通过DOM添加样式
  function addStyleWithDOM (cssText) {
    const styleNode = document.createElement('style')
    styleNode.appendChild(document.createTextNode(cssText));
    (document.querySelector('head') || document.documentElement).appendChild(styleNode)
  }

  // 执行，并且判断是否成功
  const resultsOfEnforcement = addStyleWithGM(cssContent)

  // 如果不成功，则使用DOM方式
  if (!resultsOfEnforcement) {
    addStyleWithDOM(cssContent)
  }
})()
